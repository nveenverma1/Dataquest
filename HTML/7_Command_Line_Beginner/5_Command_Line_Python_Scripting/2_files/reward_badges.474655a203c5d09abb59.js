(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{406:function(e){e.exports={next_suggestion:["complete_mission_steps","complete_missions","view_hints","upvote_qa","progress_days","progress_weeks"],badges:{complete_mission_steps:{title:"Screen Master",description:"completing $N code screens.",levels:[1,50,200]},complete_missions:{title:"Mission Master",description:"completing $N missions.",levels:[1,10,100]},view_hints:{title:"Hint Finder",description:"viewing $N hints.",levels:[1,10,100]},progress_days:{title:"Daily Streak",description:"earning progress $N days in a row.",levels:[2,5,30]},progress_weeks:{title:"Weekly Streak",description:"earning progress $N weeks in a row",levels:[2,5,30]},problem_solver:{title:"Determined Coder",description:"completing $N code screens after three attempts.",levels:[1,10,50]},no_peaking:{title:"Independent Learner",description:"completing $N code screens without first looking at the answer.",levels:[1,10,100]},answer_qa:{title:"Community Educator",description:"answering $N Q&A questions.",levels:[1,3,20]},upvote_qa:{title:"Community Contributor",description:"upvoting $N Q&A answers.",levels:[1,5,30]},mission_referece:{title:"Troubleshooter",description:"searching with mission reference $N times.",levels:[1,3,20]},profile:{title:"Creative Customizer",description:"completing profile page.",levels:[1]}}}},408:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"save_badge",function(){return E}),n.d(a,"load_badges",function(){return $});var r=n(8),s=n.n(r),i=n(5),o=n(6),d=n(2),c=n.n(d),_=n(406),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p={badges_by_id:c.a.mapValues(_.badges,function(e){return u({},e,{date_earned:null,state:{count:0}})}),next_order:_.next_suggestion,last_earned_id:""},g="reward_badges",f=Object(o.make_simple_selectors)(p,g),b=Object(i.createSelector)(f.last_earned_id,f.badges_by_id,function(e,t){return c.a.defaultTo(t[e],{})}),v=Object(i.createSelector)(f.badges_by_id,function(e){return c.a.map(e,function(e,t){return u({},e,{key:t})})}),m=Object(i.createSelector)(f.next_order,f.badges_by_id,function(e,t){return e.reduce(function(e,n){return e||(c.a.get(t,[n,"date_earned"])?null:t[n])},null)}),w=u({},f,{last_earned:b,next_suggestion:m,badges:v}),y={reset:function(){return s()(p)},ack_just_earned:function(e){return e.merge({last_earned_id:""})}};function h(e){var t=e.levels,n=e.new_count,a=e.old_count;return n!==a&&void 0!==c.a.find(t,function(e){return e===n})}var k={set_badges:function(e,t){var n=t.payload;return c.a.forEach(n,function(t){e=e.merge({badges_by_id:u({},e.badges_by_id,l({},t.badge_id,u({},e.badges_by_id[t.badge_id],{state:JSON.parse(t.state),date_earned:c.a.defaultTo(t.date_earned,"")})))})}),e},update_badge:function(e,t){var n=t.payload,a=e.badges_by_id[n.badge_id],r=h({levels:a.levels,new_count:n.state.count,old_count:a.state.count});return e.merge({badges_by_id:l({},n.badge_id,{earned:c.a.defaultTo(n.earned,a.earned),state:n.state,date_earned:c.a.defaultTo(n.date_earned,a.date_earned)}),last_earned_id:r?n.badge_id:e.last_earned_id},{deep:!0})}},O=Object(o.make_reducer_n_actions)({public_handlers:y,private_handlers:k,action_types_prefix:"reward_badges/",initial_state:p,Immutable:s.a}),S=O.reducer,j=O.private_actions,N=O.actions,x=O.ACTION_TYPES,T=S,C=n(4),E=function(e){return function(t,n){var a='mutation {\n    store_badge(\n      badge_id: "'+e.badge_id+'"\n      '+(e.date_earned?'date_earned: "'+e.date_earned+'"':"")+'\n      state: "'+Object(C.d)(JSON.stringify(e.state))+'"\n    ) {\n      badge {badge_id}\n    }\n  }';return t(j.update_badge(e)),Object(C.c)(a)}},$=function(){return function(e,t){return Object(C.c)("{\n  rewards {\n    badges {\n      badge_id\n      state\n      date_earned\n    }\n  }\n}").then(function(t){e(j.set_badges(t.data.rewards.badges))})}},q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},A=function(e){return function(t){return Math.floor(new Date(t).valueOf()/e)}},D=A(864e5),I=A(6048e5),P=function(e,t){return h({levels:t.levels,new_count:e.state.count,old_count:t.state.count})&&(e.date_earned=(new Date).toISOString()),Y.save_badge(e)},M=function(e){return function(t){var n=t.dispatch,a=t.getState,r=w.badges_by_id(a())[e];n(P({badge_id:e,state:{count:r.state.count+1}},r))}},J=function(e,t){return function(n){var a=n.dispatch,r=n.getState,s=(n.payload,w.badges_by_id(r())[e]),i=s.state,o=Date.now();if(0===i.count)i={count:1,last_update:o};else{var d=t(o)-t(i.last_update);if(i.current_streak>0)i=function(e,t){var n=Date.now();if(e<1)return t;if(1===e){var a=t.current_streak+1;t=a>=t.count?{count:a,last_update:n}:q({},t,{current_streak:a,last_update:n})}else t={count:t.count,current_streak:1,last_update:n};return t}(d,i);else{if(d<1)return;i=1===d?{count:i.count+1,last_update:o}:{count:i.count,current_streak:1,last_update:o}}}a(P({badge_id:e,state:i},s))}},B={"progress/complete_mission_step":[J("progress_days",D),J("progress_weeks",I),function(e){var t=e.dispatch,n=e.getState;e.payload.all_completed&&M("complete_missions")({dispatch:t,getState:n})},function(e){var t=e.dispatch,n=e.getState;"text"!==e.payload.type&&M("complete_mission_steps")({dispatch:t,getState:n})},function(e){var t=e.dispatch,n=e.getState,a=e.payload;if("text"!==a.type){var r=w.badges_by_id(n()).no_peaking.state;null!=r.saw_on_screen_id&&r.saw_on_screen_id===a.screen_id||M("no_peaking")({dispatch:t,getState:n})}}],"steps_info/set_show_answer":function(e){var t=e.dispatch,n=e.getState;if(!1!==e.payload){var a=w.badges_by_id(n()).no_peaking,r=a.state;r=q({},r,{saw_on_screen_id:function(e){return e().steps_info.steps_info[e().steps_info.current].id}(n)}),t(P({badge_id:"no_peaking",state:r},a))}},"steps_info/checking_results":function(e){var t=e.dispatch,n=e.getState,a=e.payload,r=w.badges_by_id(n()).problem_solver,s=r.state;!1===a.output.check&&(s=a.screen!==s.screen_id?q({},s,{wrong_count:1,screen_id:a.screen}):q({},s,{wrong_count:s.wrong_count+1})),!0===a.output.check&&(s=s.wrong_count<3?{count:s.count}:a.screen!==s.screen_id?{count:s.count}:{count:s.count+1}),t(P({badge_id:"problem_solver",state:s},r))},"steps_info/set_show_help":function(e){!1!==e.payload&&M("view_hints")(e)},"q_a_info/answered_question":M("answer_qa"),"q_a_info/set_vote":function(e){!1!==e.payload&&M("upvote_qa")(e)},"mission_reference_info/set_results":M("mission_referece"),"profile_info/update_profile":M("profile")},F=n(44),H=function(e){return function(){return{type:"AB_REMOVED_ACTION",org_type:e}}},L=function(e){return function(){return function(t){return t(H(e)())}}};function Q(e,t){c.a.forEach(e,function(n,a){var r=t+a;e[a]=c.a.isFunction(e[a])?L(r):H(r)})}var R=n(83),V=n(10);n.d(t,"actions",function(){return Y}),n.d(t,"selectors",function(){return w}),n.d(t,"BASE_SELECTOR_PATH",function(){return g}),n.d(t,"ACTION_TYPES",function(){return x}),n.d(t,"private_actions",function(){return j}),n.d(t,"middleware_handlers",function(){return B});var Y=Object.assign({},N,a);(function(e){var t=e.store,n=e.ab_id,a=e.removal_weight,r=e.actions,s=e.private_actions,i=e.action_types_prefix;(0,t.dispatch)(F.a.get_variant({experiment_id:n,variants:{removed:a,"not removed":100-a},only_after_login:!0})).then(function(e){"removed"===e&&(Q(r,i),Q(s,i))})})({store:Object(R.a)(),ab_id:"reward_badges",removal_weight:80,actions:Y,private_actions:j,action_types_prefix:"reward_badges/"});t.default=Object(V.a)({reward_badges:T})}}]);
//# sourceMappingURL=reward_badges.474655a203c5d09abb59.js.map